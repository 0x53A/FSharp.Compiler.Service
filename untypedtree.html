<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Compiler Services: Processing untyped syntax tree
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="F# compiler services for creating IDE tools, language extensions and for F# embedding">
    <meta name="author" content="Microsoft Corporation, Dave Thomas, Anh-Dung Phan, Tomas Petricek">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="http://fsharp.github.io/FSharp.Compiler.Service/content/style.css" />
    <script type="text/javascript" src="http://fsharp.github.io/FSharp.Compiler.Service/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/fsharp/FSharp.Compiler.Service">github page</a></li>
        </ul>
        <h3 class="muted">F# Compiler Services</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1>Compiler Services: Processing untyped syntax tree</h1>

<p>This tutorial demonstrates how to get the untyped abstract syntax tree (AST)
for F# code and how to walk over the tree. This can be used for creating tools
such as code formatter, basic refactoring or code navigation tools. The untyped
syntax tree contains information about the code structure, but does not contain
types and there are some ambiguities that are resolved only later by the type
checker. You can also combine the untyped AST information with the API available
from <a href="editor.html">editor services</a>.</p>

<h2>Getting the untyped AST</h2>

<p>To access the untyped AST, you need to create an instance of <code>InteractiveChecker</code>.
This type represents a context for type checking and parsing and corresponds either
to a stand-alone F# script file (e.g. opened in Visual Studio) or to a loaded project
file with multiple files. Once you have an instance of <code>InteractiveChecker</code>, you can
use it to perform "untyped parse" which is the first step of type-checking. The
second phase is "typed parse" and is used by <a href="editor.html">editor services</a>.</p>

<p>To use the interactive checker, reference <code>FSharp.Compiler.Services.dll</code> and open the
<code>SourceCodeServices</code> namespace:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">FSharp</span><span class="s">.</span><span class="s">Compiler</span><span class="s">.</span><span class="s">Service</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Microsoft</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Compiler</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">SourceCodeServices</span></pre>
</td>
</tr>
</table>

<h3>Performing untyped parse</h3>

<p>The untyped parse operation is very fast (compared to type checking, which can 
take notable amount of time) and so we can perform it synchronously. First, we
need to create <code>InteractiveChecker</code> - the constructor takes an argument that
can be used to notify the checker about file changes (which we ignore).</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Create an interactive checker instance (ignore notifications)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">notify</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">NotifyFileTypeCheckStateIsDirty</span> <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">ignore</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 9)" onmouseover="showTip(event, 'fs9', 9)" class="i">checker</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 10)" onmouseover="showTip(event, 'fs10', 10)" class="i">InteractiveChecker</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 11)" onmouseover="showTip(event, 'fs11', 11)" class="i">Create</span>(<span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">notify</span>)</pre>
</td>
</tr>
</table>

<p>To get the AST, we define a function that takes file name and the source code
(the file is only used for location information and does not have to exist).
We first need to get "interactive checker options" which represents the context.
For simple tasks, you can use <code>GetCheckOptionsFromScriptRoot</code> which infers
the context for a script file. Then we use the <code>UntypedParse</code> method and
return the <code>ParseTree</code> property:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// Get untyped tree for a specified input</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 13)" onmouseover="showTip(event, 'fs12', 13)" class="i">getUntypedTree</span> (<span onmouseout="hideTip(event, 'fs13', 14)" onmouseover="showTip(event, 'fs13', 14)" class="i">file</span>, <span onmouseout="hideTip(event, 'fs14', 15)" onmouseover="showTip(event, 'fs14', 15)" class="i">input</span>) <span class="o">=</span> 
  <span class="c">// Get compiler options for a single script file</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 16)" onmouseover="showTip(event, 'fs15', 16)" class="i">checkOptions</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs9', 17)" onmouseover="showTip(event, 'fs9', 17)" class="i">checker</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 18)" onmouseover="showTip(event, 'fs16', 18)" class="i">GetCheckOptionsFromScriptRoot</span>(<span onmouseout="hideTip(event, 'fs13', 19)" onmouseover="showTip(event, 'fs13', 19)" class="i">file</span>, <span onmouseout="hideTip(event, 'fs14', 20)" onmouseover="showTip(event, 'fs14', 20)" class="i">input</span>, <span onmouseout="hideTip(event, 'fs17', 21)" onmouseover="showTip(event, 'fs17', 21)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 22)" onmouseover="showTip(event, 'fs18', 22)" class="i">Now</span>, [| |])
  <span class="c">// Run the first phase (untyped parsing) of the compiler</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 23)" onmouseover="showTip(event, 'fs19', 23)" class="i">untypedRes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 24)" onmouseover="showTip(event, 'fs9', 24)" class="i">checker</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 25)" onmouseover="showTip(event, 'fs20', 25)" class="i">UntypedParse</span>(<span onmouseout="hideTip(event, 'fs13', 26)" onmouseover="showTip(event, 'fs13', 26)" class="i">file</span>, <span onmouseout="hideTip(event, 'fs14', 27)" onmouseover="showTip(event, 'fs14', 27)" class="i">input</span>, <span onmouseout="hideTip(event, 'fs15', 28)" onmouseover="showTip(event, 'fs15', 28)" class="i">checkOptions</span>)
  <span class="k">match</span> <span onmouseout="hideTip(event, 'fs19', 29)" onmouseover="showTip(event, 'fs19', 29)" class="i">untypedRes</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 30)" onmouseover="showTip(event, 'fs21', 30)" class="i">ParseTree</span> <span class="k">with</span>
  | <span onmouseout="hideTip(event, 'fs22', 31)" onmouseover="showTip(event, 'fs22', 31)" class="i">Some</span> <span onmouseout="hideTip(event, 'fs23', 32)" onmouseover="showTip(event, 'fs23', 32)" class="i">tree</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs23', 33)" onmouseover="showTip(event, 'fs23', 33)" class="i">tree</span>
  | <span onmouseout="hideTip(event, 'fs24', 34)" onmouseover="showTip(event, 'fs24', 34)" class="i">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs25', 35)" onmouseover="showTip(event, 'fs25', 35)" class="i">failwith</span> <span class="s">&quot;</span><span class="s">Something</span><span class="s"> </span><span class="s">went</span><span class="s"> </span><span class="s">wrong</span><span class="s"> </span><span class="s">during</span><span class="s"> </span><span class="s">parsing</span><span class="s">!</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>The documentation for <code>InteractiveChecker</code> is currently work in progress, but
you can find some information in the inline comments in the F# source code 
repository (<a href="https://github.com/fsharp/fsharp/blob/fsharp_31/src/fsharp/vs/service.fsi">see <code>service.fsi</code> source code</a>).</p>

<h2>Walking over the AST</h2>

<p>The abstract syntax tree is defined as a number of discriminated unions that represent
different syntactical elements (such as expressions, patterns, declarations etc.). The best
way to understand the AST is to look at the definitions in <a href="https://github.com/fsharp/fsharp/blob/master/src/fsharp/ast.fs#L464"><code>ast.fs</code> in the source 
code</a>.</p>

<p>The relevant parts are in the following namespace:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 36)" onmouseover="showTip(event, 'fs2', 36)" class="i">Microsoft</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 37)" onmouseover="showTip(event, 'fs3', 37)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 38)" onmouseover="showTip(event, 'fs4', 38)" class="i">Compiler</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 39)" onmouseover="showTip(event, 'fs26', 39)" class="i">Ast</span></pre>
</td>
</tr>
</table>

<p>When processing the AST, you will typically write a number of mutually recursive functions
that pattern match on the different syntactical elements. There is a number of elements
that need to be supported - the top-level element is module or namespace declaration, 
containing declarations inside a module (let bindings, types etc.). A let declaration inside
a module then contains expression, which can contain patterns.</p>

<h3>Walking over patterns and expressions</h3>

<p>We start by looking at functions that walk over expressions and patterns - as we walk,
we print information about the visited elements. For patterns, the input is of type
<code>SynPat</code> and has a number of cases including <code>Wild</code> (for <code>_</code> pattern), <code>Named</code> (for
<code>&lt;pat&gt; as name</code>) and <code>LongIdent</code> (for a <code>Foo.Bar</code> name). Note that the parsed pattern
is occasionally more complex than what is in the source code (in particular, <code>Named</code> is
used more often):</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// Walk over a pattern - this is for example used in </span>
<span class="c">/// let &lt;pat&gt; = &lt;expr&gt; or in the &#39;match&#39; expression</span>
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs27', 40)" onmouseover="showTip(event, 'fs27', 40)" class="i">visitPattern</span> <span class="o">=</span> <span class="k">function</span>
  | <span onmouseout="hideTip(event, 'fs28', 41)" onmouseover="showTip(event, 'fs28', 41)" class="i">SynPat</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 42)" onmouseover="showTip(event, 'fs29', 42)" class="i">Wild</span>(_) <span class="k">-&gt;</span> 
      <span onmouseout="hideTip(event, 'fs30', 43)" onmouseover="showTip(event, 'fs30', 43)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">  </span><span class="s">.</span><span class="s">.</span><span class="s"> </span><span class="s">underscore</span><span class="s"> </span><span class="s">pattern</span><span class="s">&quot;</span>
  | <span onmouseout="hideTip(event, 'fs28', 44)" onmouseover="showTip(event, 'fs28', 44)" class="i">SynPat</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 45)" onmouseover="showTip(event, 'fs31', 45)" class="i">Named</span>(<span onmouseout="hideTip(event, 'fs32', 46)" onmouseover="showTip(event, 'fs32', 46)" class="i">pat</span>, <span onmouseout="hideTip(event, 'fs33', 47)" onmouseover="showTip(event, 'fs33', 47)" class="i">name</span>, _, _, _) <span class="k">-&gt;</span>
      <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="i">visitPattern</span> <span onmouseout="hideTip(event, 'fs32', 49)" onmouseover="showTip(event, 'fs32', 49)" class="i">pat</span>
      <span onmouseout="hideTip(event, 'fs30', 50)" onmouseover="showTip(event, 'fs30', 50)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">  </span><span class="s">.</span><span class="s">.</span><span class="s"> </span><span class="s">named</span><span class="s"> </span><span class="s">as</span><span class="s"> </span><span class="s">&#39;</span><span class="s">%</span><span class="s">s&#39;</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs33', 51)" onmouseover="showTip(event, 'fs33', 51)" class="i">name</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 52)" onmouseover="showTip(event, 'fs34', 52)" class="i">idText</span>
  | <span onmouseout="hideTip(event, 'fs28', 53)" onmouseover="showTip(event, 'fs28', 53)" class="i">SynPat</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 54)" onmouseover="showTip(event, 'fs35', 54)" class="i">LongIdent</span>(<span onmouseout="hideTip(event, 'fs36', 55)" onmouseover="showTip(event, 'fs36', 55)" class="i">LongIdentWithDots</span>(<span onmouseout="hideTip(event, 'fs37', 56)" onmouseover="showTip(event, 'fs37', 56)" class="i">ident</span>, _), _, _, _, _, _) <span class="k">-&gt;</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs38', 57)" onmouseover="showTip(event, 'fs38', 57)" class="i">names</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 58)" onmouseover="showTip(event, 'fs39', 58)" class="i">String</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 59)" onmouseover="showTip(event, 'fs40', 59)" class="i">concat</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">&quot;</span> [ <span class="k">for</span> <span onmouseout="hideTip(event, 'fs41', 60)" onmouseover="showTip(event, 'fs41', 60)" class="i">i</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs37', 61)" onmouseover="showTip(event, 'fs37', 61)" class="i">ident</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs41', 62)" onmouseover="showTip(event, 'fs41', 62)" class="i">i</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 63)" onmouseover="showTip(event, 'fs34', 63)" class="i">idText</span> ]
      <span onmouseout="hideTip(event, 'fs30', 64)" onmouseover="showTip(event, 'fs30', 64)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">  </span><span class="s">.</span><span class="s">.</span><span class="s"> </span><span class="s">identifier</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs38', 65)" onmouseover="showTip(event, 'fs38', 65)" class="i">names</span>
  | <span onmouseout="hideTip(event, 'fs32', 66)" onmouseover="showTip(event, 'fs32', 66)" class="i">pat</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs30', 67)" onmouseover="showTip(event, 'fs30', 67)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">  </span><span class="s">.</span><span class="s">.</span><span class="s"> </span><span class="s">other</span><span class="s"> </span><span class="s">pattern</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs32', 68)" onmouseover="showTip(event, 'fs32', 68)" class="i">pat</span></pre>
</td>
</tr>
</table>

<p>The function is recursive (for nested patterns such as <code>(foo, _) as bar</code>), but it does not
call any of the functions defined later (because patterns cannot contain other syntactical 
elements).</p>

<p>The next function iterates over expressions - this is where most of the work would be and
there are around 20 cases to cover (type <code>SynExpr.</code> and you'll get completion with other 
options). In the following, we only show how to handle <code>if .. then ..</code> and <code>let .. = ...</code>:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// Walk over an expression - if expression contains two or three </span>
<span class="c">/// sub-expressions (two if the &#39;else&#39; branch is missing), let expression</span>
<span class="c">/// contains pattern and two sub-expressions</span>
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs42', 69)" onmouseover="showTip(event, 'fs42', 69)" class="i">visitExpression</span> <span class="o">=</span> <span class="k">function</span>
  | <span onmouseout="hideTip(event, 'fs43', 70)" onmouseover="showTip(event, 'fs43', 70)" class="i">SynExpr</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs44', 71)" onmouseover="showTip(event, 'fs44', 71)" class="i">IfThenElse</span>(<span onmouseout="hideTip(event, 'fs45', 72)" onmouseover="showTip(event, 'fs45', 72)" class="i">cond</span>, <span onmouseout="hideTip(event, 'fs46', 73)" onmouseover="showTip(event, 'fs46', 73)" class="i">trueBranch</span>, <span onmouseout="hideTip(event, 'fs47', 74)" onmouseover="showTip(event, 'fs47', 74)" class="i">falseBranchOpt</span>, _, _, _, _) <span class="k">-&gt;</span>
      <span class="c">// Visit all sub-expressions</span>
      <span onmouseout="hideTip(event, 'fs30', 75)" onmouseover="showTip(event, 'fs30', 75)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Conditional</span><span class="s">:</span><span class="s">&quot;</span>
      <span onmouseout="hideTip(event, 'fs42', 76)" onmouseover="showTip(event, 'fs42', 76)" class="i">visitExpression</span> <span onmouseout="hideTip(event, 'fs45', 77)" onmouseover="showTip(event, 'fs45', 77)" class="i">cond</span>
      <span onmouseout="hideTip(event, 'fs42', 78)" onmouseover="showTip(event, 'fs42', 78)" class="i">visitExpression</span> <span onmouseout="hideTip(event, 'fs46', 79)" onmouseover="showTip(event, 'fs46', 79)" class="i">trueBranch</span>
      <span onmouseout="hideTip(event, 'fs47', 80)" onmouseover="showTip(event, 'fs47', 80)" class="i">falseBranchOpt</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs48', 81)" onmouseover="showTip(event, 'fs48', 81)" class="i">Option</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 82)" onmouseover="showTip(event, 'fs49', 82)" class="i">iter</span> <span onmouseout="hideTip(event, 'fs42', 83)" onmouseover="showTip(event, 'fs42', 83)" class="i">visitExpression</span> 

  | <span onmouseout="hideTip(event, 'fs43', 84)" onmouseover="showTip(event, 'fs43', 84)" class="i">SynExpr</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs50', 85)" onmouseover="showTip(event, 'fs50', 85)" class="i">LetOrUse</span>(_, _, <span onmouseout="hideTip(event, 'fs51', 86)" onmouseover="showTip(event, 'fs51', 86)" class="i">bindings</span>, <span onmouseout="hideTip(event, 'fs52', 87)" onmouseover="showTip(event, 'fs52', 87)" class="i">body</span>, _) <span class="k">-&gt;</span>
      <span class="c">// Visit bindings (there may be multiple </span>
      <span class="c">// for &#39;let .. = .. and .. = .. in ...&#39;</span>
      <span onmouseout="hideTip(event, 'fs30', 88)" onmouseover="showTip(event, 'fs30', 88)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">LetOrUse</span><span class="s"> </span><span class="s">with</span><span class="s"> </span><span class="s">the</span><span class="s"> </span><span class="s">following</span><span class="s"> </span><span class="s">bindings</span><span class="s">:</span><span class="s">&quot;</span>
      <span class="k">for</span> <span onmouseout="hideTip(event, 'fs53', 89)" onmouseover="showTip(event, 'fs53', 89)" class="i">binding</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs51', 90)" onmouseover="showTip(event, 'fs51', 90)" class="i">bindings</span> <span class="k">do</span>
        <span class="k">let</span> (<span onmouseout="hideTip(event, 'fs54', 91)" onmouseover="showTip(event, 'fs54', 91)" class="i">Binding</span>(<span onmouseout="hideTip(event, 'fs55', 92)" onmouseover="showTip(event, 'fs55', 92)" class="i">access</span>, <span onmouseout="hideTip(event, 'fs56', 93)" onmouseover="showTip(event, 'fs56', 93)" class="i">kind</span>, <span onmouseout="hideTip(event, 'fs57', 94)" onmouseover="showTip(event, 'fs57', 94)" class="i">inlin</span>, <span onmouseout="hideTip(event, 'fs58', 95)" onmouseover="showTip(event, 'fs58', 95)" class="i">mutabl</span>, <span onmouseout="hideTip(event, 'fs59', 96)" onmouseover="showTip(event, 'fs59', 96)" class="i">attrs</span>, <span onmouseout="hideTip(event, 'fs60', 97)" onmouseover="showTip(event, 'fs60', 97)" class="i">xmlDoc</span>, 
                     <span onmouseout="hideTip(event, 'fs61', 98)" onmouseover="showTip(event, 'fs61', 98)" class="i">data</span>, <span onmouseout="hideTip(event, 'fs32', 99)" onmouseover="showTip(event, 'fs32', 99)" class="i">pat</span>, <span onmouseout="hideTip(event, 'fs62', 100)" onmouseover="showTip(event, 'fs62', 100)" class="i">retInfo</span>, <span onmouseout="hideTip(event, 'fs63', 101)" onmouseover="showTip(event, 'fs63', 101)" class="i">init</span>, <span onmouseout="hideTip(event, 'fs64', 102)" onmouseover="showTip(event, 'fs64', 102)" class="i">m</span>, <span onmouseout="hideTip(event, 'fs65', 103)" onmouseover="showTip(event, 'fs65', 103)" class="i">sp</span>)) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs53', 104)" onmouseover="showTip(event, 'fs53', 104)" class="i">binding</span>
        <span onmouseout="hideTip(event, 'fs27', 105)" onmouseover="showTip(event, 'fs27', 105)" class="i">visitPattern</span> <span onmouseout="hideTip(event, 'fs32', 106)" onmouseover="showTip(event, 'fs32', 106)" class="i">pat</span> 
        <span onmouseout="hideTip(event, 'fs42', 107)" onmouseover="showTip(event, 'fs42', 107)" class="i">visitExpression</span> <span onmouseout="hideTip(event, 'fs63', 108)" onmouseover="showTip(event, 'fs63', 108)" class="i">init</span>
      <span class="c">// Visit the body expression</span>
      <span onmouseout="hideTip(event, 'fs30', 109)" onmouseover="showTip(event, 'fs30', 109)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">And</span><span class="s"> </span><span class="s">the</span><span class="s"> </span><span class="s">following</span><span class="s"> </span><span class="s">body</span><span class="s">:</span><span class="s">&quot;</span>
      <span onmouseout="hideTip(event, 'fs42', 110)" onmouseover="showTip(event, 'fs42', 110)" class="i">visitExpression</span> <span onmouseout="hideTip(event, 'fs52', 111)" onmouseover="showTip(event, 'fs52', 111)" class="i">body</span>
  | <span onmouseout="hideTip(event, 'fs66', 112)" onmouseover="showTip(event, 'fs66', 112)" class="i">expr</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs30', 113)" onmouseover="showTip(event, 'fs30', 113)" class="i">printfn</span> <span class="s">&quot;</span><span class="s"> </span><span class="s">-</span><span class="s"> </span><span class="s">not</span><span class="s"> </span><span class="s">supported</span><span class="s"> </span><span class="s">expression</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs66', 114)" onmouseover="showTip(event, 'fs66', 114)" class="i">expr</span></pre>
</td>
</tr>
</table>

<p>The <code>visitExpression</code> function will be called from a function that visits all top-level
declarations inside a module. In this tutorial, we ignore types and members, but that would
be another source of calls to <code>visitExpression</code>.</p>

<h3>Walking over declarations</h3>

<p>As mentioned earlier, the AST of a file contains a number of module or namespace declarations
(top-level node) that contain declarations inside a module (let bindings or types) or inisde
a namespace (just types). The following functions walks over declarations - we ignore types,
nested modules and all other elements and look only at top-level <code>let</code> bindings (values and 
functions):</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// Walk over a list of declarations in a module. This is anything</span>
<span class="c">/// that you can write as a top-level inside module (let bindings,</span>
<span class="c">/// nested modules, type declarations etc.)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs67', 115)" onmouseover="showTip(event, 'fs67', 115)" class="i">visitDeclarations</span> <span onmouseout="hideTip(event, 'fs68', 116)" onmouseover="showTip(event, 'fs68', 116)" class="i">decls</span> <span class="o">=</span> 
  <span class="k">for</span> <span onmouseout="hideTip(event, 'fs69', 117)" onmouseover="showTip(event, 'fs69', 117)" class="i">declaration</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs68', 118)" onmouseover="showTip(event, 'fs68', 118)" class="i">decls</span> <span class="k">do</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs69', 119)" onmouseover="showTip(event, 'fs69', 119)" class="i">declaration</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs70', 120)" onmouseover="showTip(event, 'fs70', 120)" class="i">SynModuleDecl</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 121)" onmouseover="showTip(event, 'fs71', 121)" class="i">Let</span>(<span onmouseout="hideTip(event, 'fs72', 122)" onmouseover="showTip(event, 'fs72', 122)" class="i">isRec</span>, <span onmouseout="hideTip(event, 'fs51', 123)" onmouseover="showTip(event, 'fs51', 123)" class="i">bindings</span>, <span onmouseout="hideTip(event, 'fs73', 124)" onmouseover="showTip(event, 'fs73', 124)" class="i">range</span>) <span class="k">-&gt;</span>
        <span class="c">// Let binding as a declaration is similar to let binding</span>
        <span class="c">// as an expression (in visitExpression), but has no body</span>
        <span class="k">for</span> <span onmouseout="hideTip(event, 'fs53', 125)" onmouseover="showTip(event, 'fs53', 125)" class="i">binding</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs51', 126)" onmouseover="showTip(event, 'fs51', 126)" class="i">bindings</span> <span class="k">do</span>
          <span class="k">let</span> (<span onmouseout="hideTip(event, 'fs54', 127)" onmouseover="showTip(event, 'fs54', 127)" class="i">Binding</span>(<span onmouseout="hideTip(event, 'fs55', 128)" onmouseover="showTip(event, 'fs55', 128)" class="i">access</span>, <span onmouseout="hideTip(event, 'fs56', 129)" onmouseover="showTip(event, 'fs56', 129)" class="i">kind</span>, <span onmouseout="hideTip(event, 'fs57', 130)" onmouseover="showTip(event, 'fs57', 130)" class="i">inlin</span>, <span onmouseout="hideTip(event, 'fs58', 131)" onmouseover="showTip(event, 'fs58', 131)" class="i">mutabl</span>, <span onmouseout="hideTip(event, 'fs59', 132)" onmouseover="showTip(event, 'fs59', 132)" class="i">attrs</span>, <span onmouseout="hideTip(event, 'fs60', 133)" onmouseover="showTip(event, 'fs60', 133)" class="i">xmlDoc</span>, 
                       <span onmouseout="hideTip(event, 'fs61', 134)" onmouseover="showTip(event, 'fs61', 134)" class="i">data</span>, <span onmouseout="hideTip(event, 'fs32', 135)" onmouseover="showTip(event, 'fs32', 135)" class="i">pat</span>, <span onmouseout="hideTip(event, 'fs62', 136)" onmouseover="showTip(event, 'fs62', 136)" class="i">retInfo</span>, <span onmouseout="hideTip(event, 'fs52', 137)" onmouseover="showTip(event, 'fs52', 137)" class="i">body</span>, <span onmouseout="hideTip(event, 'fs64', 138)" onmouseover="showTip(event, 'fs64', 138)" class="i">m</span>, <span onmouseout="hideTip(event, 'fs65', 139)" onmouseover="showTip(event, 'fs65', 139)" class="i">sp</span>)) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs53', 140)" onmouseover="showTip(event, 'fs53', 140)" class="i">binding</span>
          <span onmouseout="hideTip(event, 'fs27', 141)" onmouseover="showTip(event, 'fs27', 141)" class="i">visitPattern</span> <span onmouseout="hideTip(event, 'fs32', 142)" onmouseover="showTip(event, 'fs32', 142)" class="i">pat</span> 
          <span onmouseout="hideTip(event, 'fs42', 143)" onmouseover="showTip(event, 'fs42', 143)" class="i">visitExpression</span> <span onmouseout="hideTip(event, 'fs52', 144)" onmouseover="showTip(event, 'fs52', 144)" class="i">body</span>         
    | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs30', 145)" onmouseover="showTip(event, 'fs30', 145)" class="i">printfn</span> <span class="s">&quot;</span><span class="s"> </span><span class="s">-</span><span class="s"> </span><span class="s">not</span><span class="s"> </span><span class="s">supported</span><span class="s"> </span><span class="s">declaration</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs69', 146)" onmouseover="showTip(event, 'fs69', 146)" class="i">declaration</span></pre>
</td>
</tr>
</table>

<p>The <code>visitDeclarations</code> function will be called from a function that walks over a 
sequence of module or namespace declarations. This corresponds, for example, to a file 
with multiple <code>namespace Foo</code> declarations:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// Walk over all module or namespace declarations </span>
<span class="c">/// (basically &#39;module Foo =&#39; or &#39;namespace Foo.Bar&#39;)</span>
<span class="c">/// Note that there is one implicitly, even if the file</span>
<span class="c">/// does not explicitly define it..</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs74', 147)" onmouseover="showTip(event, 'fs74', 147)" class="i">visitModulesAndNamespaces</span> <span onmouseout="hideTip(event, 'fs75', 148)" onmouseover="showTip(event, 'fs75', 148)" class="i">modulesOrNss</span> <span class="o">=</span>
  <span class="k">for</span> <span onmouseout="hideTip(event, 'fs76', 149)" onmouseover="showTip(event, 'fs76', 149)" class="i">moduleOrNs</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs75', 150)" onmouseover="showTip(event, 'fs75', 150)" class="i">modulesOrNss</span> <span class="k">do</span>
    <span class="k">let</span> (<span onmouseout="hideTip(event, 'fs77', 151)" onmouseover="showTip(event, 'fs77', 151)" class="i">SynModuleOrNamespace</span>(<span onmouseout="hideTip(event, 'fs78', 152)" onmouseover="showTip(event, 'fs78', 152)" class="i">lid</span>, <span onmouseout="hideTip(event, 'fs79', 153)" onmouseover="showTip(event, 'fs79', 153)" class="i">isMod</span>, <span onmouseout="hideTip(event, 'fs80', 154)" onmouseover="showTip(event, 'fs80', 154)" class="i">decls</span>, <span onmouseout="hideTip(event, 'fs81', 155)" onmouseover="showTip(event, 'fs81', 155)" class="i">xml</span>, <span onmouseout="hideTip(event, 'fs59', 156)" onmouseover="showTip(event, 'fs59', 156)" class="i">attrs</span>, _, <span onmouseout="hideTip(event, 'fs64', 157)" onmouseover="showTip(event, 'fs64', 157)" class="i">m</span>)) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs76', 158)" onmouseover="showTip(event, 'fs76', 158)" class="i">moduleOrNs</span>
    <span onmouseout="hideTip(event, 'fs30', 159)" onmouseover="showTip(event, 'fs30', 159)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Namespace</span><span class="s"> </span><span class="s">or</span><span class="s"> </span><span class="s">module</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs78', 160)" onmouseover="showTip(event, 'fs78', 160)" class="i">lid</span>
    <span onmouseout="hideTip(event, 'fs67', 161)" onmouseover="showTip(event, 'fs67', 161)" class="i">visitDeclarations</span> <span onmouseout="hideTip(event, 'fs80', 162)" onmouseover="showTip(event, 'fs80', 162)" class="i">decls</span></pre>
</td>
</tr>
</table>

<p>Now that we have functions that walk over the elements of the AST (starting from declaration,
down to expressions and patterns), we can get AST of a sample input and run the above function.</p>

<h2>Putting things together</h2>

<p>As already discussed, the <code>getUntypedTree</code> function uses <code>InteractiveChecker</code> to run the first
phase (parsing) on the AST and get back the tree. The function requires F# source code together
with location of the file. The location does not have to exist (it is used only for location 
information) and it can be in both Unix and Windows formats:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Sample input for the compiler service</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs82', 163)" onmouseover="showTip(event, 'fs82', 163)" class="i">input</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">  </span><span class="s">let</span><span class="s"> </span><span class="s">foo</span><span class="s">(</span><span class="s">)</span><span class="s"> </span><span class="s">=</span><span class="s"> </span>
<span class="s">    </span><span class="s">let</span><span class="s"> </span><span class="s">msg</span><span class="s"> </span><span class="s">=</span><span class="s"> </span><span class="s">&quot;</span><span class="s">Hello</span><span class="s"> </span><span class="s">world</span><span class="s">&quot;</span>
<span class="s">    </span><span class="s">if</span><span class="s"> </span><span class="s">true</span><span class="s"> </span><span class="s">then</span><span class="s"> </span>
<span class="s">      </span><span class="s">printfn</span><span class="s"> </span><span class="s">&quot;</span><span class="s">%</span><span class="s">s</span><span class="s">&quot;</span><span class="s"> </span><span class="s">msg</span><span class="s"> </span><span class="s">&quot;&quot;&quot;</span>
<span class="c">// File name in Unix format</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs83', 164)" onmouseover="showTip(event, 'fs83', 164)" class="i">file</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">/</span><span class="s">home</span><span class="s">/</span><span class="s">user</span><span class="s">/</span><span class="s">Test</span><span class="s">.</span><span class="s">fsx</span><span class="s">&quot;</span>

<span class="c">// Get the AST of sample F# code</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs84', 165)" onmouseover="showTip(event, 'fs84', 165)" class="i">tree</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs85', 166)" onmouseover="showTip(event, 'fs85', 166)" class="i">getUntypedTree</span>(<span onmouseout="hideTip(event, 'fs83', 167)" onmouseover="showTip(event, 'fs83', 167)" class="i">file</span>, <span onmouseout="hideTip(event, 'fs82', 168)" onmouseover="showTip(event, 'fs82', 168)" class="i">input</span>) </pre>
</td>
</tr>
</table>

<p>When you run the code in F# interactive, you can enter <code>tree;;</code> in the interactive console and
see pretty printed representation of the data structure - the tree contains a lot of information,
so this is not particularly readable, but it gives you good idea about how the tree looks.</p>

<p>The returned <code>tree</code> value is again a discriminated union that can be two different cases - one case
is <code>ParsedInput.SigFile</code> which represents F# signature file (<code>*.fsi</code>) and the other one is 
<code>ParsedInput.ImplFile</code> representing regular source code (<code>*.fsx</code> or <code>*.fs</code>). The implementation
file contains a sequence of modules or namespaces that we can pass to the function implemented
in the previous step:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Extract implementation file details</span>
<span class="k">match</span> <span onmouseout="hideTip(event, 'fs84', 169)" onmouseover="showTip(event, 'fs84', 169)" class="i">tree</span> <span class="k">with</span>
| <span onmouseout="hideTip(event, 'fs86', 170)" onmouseover="showTip(event, 'fs86', 170)" class="i">ParsedInput</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs87', 171)" onmouseover="showTip(event, 'fs87', 171)" class="i">ImplFile</span>(<span onmouseout="hideTip(event, 'fs88', 172)" onmouseover="showTip(event, 'fs88', 172)" class="i">implFile</span>) <span class="k">-&gt;</span>
    <span class="c">// Extract declarations and walk over them</span>
    <span class="k">let</span> (<span onmouseout="hideTip(event, 'fs89', 173)" onmouseover="showTip(event, 'fs89', 173)" class="i">ParsedImplFileInput</span>(<span onmouseout="hideTip(event, 'fs90', 174)" onmouseover="showTip(event, 'fs90', 174)" class="i">fn</span>, <span onmouseout="hideTip(event, 'fs91', 175)" onmouseover="showTip(event, 'fs91', 175)" class="i">script</span>, <span onmouseout="hideTip(event, 'fs92', 176)" onmouseover="showTip(event, 'fs92', 176)" class="i">name</span>, _, _, <span onmouseout="hideTip(event, 'fs93', 177)" onmouseover="showTip(event, 'fs93', 177)" class="i">modules</span>, _)) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs88', 178)" onmouseover="showTip(event, 'fs88', 178)" class="i">implFile</span>
    <span onmouseout="hideTip(event, 'fs74', 179)" onmouseover="showTip(event, 'fs74', 179)" class="i">visitModulesAndNamespaces</span> <span onmouseout="hideTip(event, 'fs93', 180)" onmouseover="showTip(event, 'fs93', 180)" class="i">modules</span>
| _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs25', 181)" onmouseover="showTip(event, 'fs25', 181)" class="i">failwith</span> <span class="s">&quot;</span><span class="s">F</span><span class="s">#</span><span class="s"> </span><span class="s">Interface</span><span class="s"> </span><span class="s">file</span><span class="s"> </span><span class="s">(</span><span class="s">*</span><span class="s">.</span><span class="s">fsi</span><span class="s">)</span><span class="s"> </span><span class="s">not</span><span class="s"> </span><span class="s">supported</span><span class="s">.</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h2>Summary</h2>

<p>In this tutorial, we looked at basic of working with the untyped abstract syntax tree. This is a 
comprehensive topic, so it is not possible to explain everything in a single article. The 
<a href="https://github.com/dungpa/fantomas">Fantomas project</a> is a good example of tool based on the untyped
AST that can help you understand more. In practice, it is also useful to combine the information here
with some information you can obtain from the <a href="editor.fsx">editor services</a> discussed in the next 
tutorial.</p>

<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace Microsoft</div>
<div class="tip" id="fs3">namespace Microsoft.FSharp</div>
<div class="tip" id="fs4">namespace Microsoft.FSharp.Compiler</div>
<div class="tip" id="fs5">namespace Microsoft.FSharp.Compiler.SourceCodeServices</div>
<div class="tip" id="fs6">val notify : NotifyFileTypeCheckStateIsDirty<br /><br />Full name: Untypedtree.notify</div>
<div class="tip" id="fs7">Multiple items<br />union case NotifyFileTypeCheckStateIsDirty.NotifyFileTypeCheckStateIsDirty: (string -&gt; unit) -&gt; NotifyFileTypeCheckStateIsDirty<br /><br />--------------------<br />type NotifyFileTypeCheckStateIsDirty = | NotifyFileTypeCheckStateIsDirty of (string -&gt; unit)<br /><br />Full name: Microsoft.FSharp.Compiler.SourceCodeServices.NotifyFileTypeCheckStateIsDirty</div>
<div class="tip" id="fs8">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>
<div class="tip" id="fs9">val checker : InteractiveChecker<br /><br />Full name: Untypedtree.checker</div>
<div class="tip" id="fs10">type InteractiveChecker<br />member ClearLanguageServiceRootCachesAndCollectAndFinalizeAllTransients : unit -&gt; unit<br />member GetCheckOptionsFromScriptRoot : filename:string * source:string * loadedTimestamp:DateTime -&gt; CheckOptions<br />member GetCheckOptionsFromScriptRoot : filename:string * source:string * loadedTimestamp:DateTime * otherFlags:string [] -&gt; CheckOptions<br />member GetSlotsCount : options:CheckOptions -&gt; int<br />member InvalidateAll : unit -&gt; unit<br />member InvalidateConfiguration : options:CheckOptions -&gt; unit<br />member MatchBraces : filename:string * source:string * options:CheckOptions -&gt; (Range * Range) []<br />member NotifyProjectCleaned : options:CheckOptions -&gt; unit<br />member StartBackgroundCompile : options:CheckOptions -&gt; unit<br />member StopBackgroundCompile : unit -&gt; unit<br />member TryGetRecentTypeCheckResultsForFile : filename:string * options:CheckOptions -&gt; (UntypedParseInfo * TypeCheckResults * int) option<br />member TypeCheckSource : parsed:UntypedParseInfo * filename:string * fileversion:int * source:string * options:CheckOptions * isResultObsolete:IsResultObsolete * textSnapshotInfo:obj -&gt; TypeCheckAnswer<br />member UntypedParse : filename:string * source:string * options:CheckOptions -&gt; UntypedParseInfo<br />member UntypedParseForSlot : slot:int * options:CheckOptions -&gt; UntypedParseInfo<br />member WaitForBackgroundCompile : unit -&gt; unit<br />static member Create : NotifyFileTypeCheckStateIsDirty -&gt; InteractiveChecker<br />static member GlobalForegroundParseCountStatistic : int<br />static member GlobalForegroundTypeCheckCountStatistic : int<br /><br />Full name: Microsoft.FSharp.Compiler.SourceCodeServices.InteractiveChecker</div>
<div class="tip" id="fs11">static member InteractiveChecker.Create : NotifyFileTypeCheckStateIsDirty -&gt; InteractiveChecker</div>
<div class="tip" id="fs12">val getUntypedTree : file:string * input:string -&gt; Compiler.Ast.ParsedInput<br /><br />Full name: Untypedtree.getUntypedTree<br /><em><br /><br />&#160;Get untyped tree for a specified input</em></div>
<div class="tip" id="fs13">val file : string</div>
<div class="tip" id="fs14">val input : string</div>
<div class="tip" id="fs15">val checkOptions : CheckOptions</div>
<div class="tip" id="fs16">member InteractiveChecker.GetCheckOptionsFromScriptRoot : filename:string * source:string * loadedTimestamp:DateTime -&gt; CheckOptions<br />member InteractiveChecker.GetCheckOptionsFromScriptRoot : filename:string * source:string * loadedTimestamp:DateTime * otherFlags:string [] -&gt; CheckOptions</div>
<div class="tip" id="fs17">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs18">property DateTime.Now: DateTime</div>
<div class="tip" id="fs19">val untypedRes : UntypedParseInfo</div>
<div class="tip" id="fs20">member InteractiveChecker.UntypedParse : filename:string * source:string * options:CheckOptions -&gt; UntypedParseInfo</div>
<div class="tip" id="fs21">property UntypedParseInfo.ParseTree: Compiler.Ast.ParsedInput option</div>
<div class="tip" id="fs22">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs23">val tree : Compiler.Ast.ParsedInput</div>
<div class="tip" id="fs24">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs25">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs26">module Ast<br /><br />from Microsoft.FSharp.Compiler</div>
<div class="tip" id="fs27">val visitPattern : _arg1:SynPat -&gt; unit<br /><br />Full name: Untypedtree.visitPattern<br /><em><br /><br />&#160;Walk over a pattern - this is for example used in <br />&#160;let &lt;pat&gt; = &lt;expr&gt; or in the &#39;match&#39; expression</em></div>
<div class="tip" id="fs28">type SynPat =<br />&#160;&#160;| Const of SynConst * range<br />&#160;&#160;| Wild of range<br />&#160;&#160;| Named of SynPat * Ident * bool * SynAccess option * range<br />&#160;&#160;| Typed of SynPat * SynType * range<br />&#160;&#160;| Attrib of SynPat * SynAttributes * range<br />&#160;&#160;| Or of SynPat * SynPat * range<br />&#160;&#160;| Ands of SynPat list * range<br />&#160;&#160;| LongIdent of LongIdentWithDots * Ident option * SynValTyparDecls option * SynConstructorArgs * SynAccess option * range<br />&#160;&#160;| Tuple of SynPat list * range<br />&#160;&#160;| Paren of SynPat * range<br />&#160;&#160;...<br />&#160;&#160;member Range : range<br /><br />Full name: Microsoft.FSharp.Compiler.Ast.SynPat</div>
<div class="tip" id="fs29">union case SynPat.Wild: Compiler.Range.range -&gt; SynPat</div>
<div class="tip" id="fs30">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs31">union case SynPat.Named: SynPat * Ident * bool * SynAccess option * Compiler.Range.range -&gt; SynPat</div>
<div class="tip" id="fs32">val pat : SynPat</div>
<div class="tip" id="fs33">val name : Ident</div>
<div class="tip" id="fs34">property Ident.idText: string</div>
<div class="tip" id="fs35">union case SynPat.LongIdent: LongIdentWithDots * Ident option * SynValTyparDecls option * SynConstructorArgs * SynAccess option * Compiler.Range.range -&gt; SynPat</div>
<div class="tip" id="fs36">Multiple items<br />union case LongIdentWithDots.LongIdentWithDots: LongIdent * Compiler.Range.range list -&gt; LongIdentWithDots<br /><br />--------------------<br />type LongIdentWithDots =<br />&#160;&#160;| LongIdentWithDots of LongIdent * range list<br />&#160;&#160;member Lid : LongIdent<br />&#160;&#160;member Range : range<br />&#160;&#160;member RangeSansAnyExtraDot : range<br />&#160;&#160;member ThereIsAnExtraDotAtTheEnd : bool<br /><br />Full name: Microsoft.FSharp.Compiler.Ast.LongIdentWithDots</div>
<div class="tip" id="fs37">val ident : LongIdent</div>
<div class="tip" id="fs38">val names : string</div>
<div class="tip" id="fs39">Multiple items<br />type String =<br />&#160;&#160;new : value:char -&gt; string + 7 overloads<br />&#160;&#160;member Chars : int -&gt; char<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;member Contains : value:string -&gt; bool<br />&#160;&#160;member CopyTo : sourceIndex:int * destination:char[] * destinationIndex:int * count:int -&gt; unit<br />&#160;&#160;member EndsWith : value:string -&gt; bool + 2 overloads<br />&#160;&#160;member Equals : obj:obj -&gt; bool + 2 overloads<br />&#160;&#160;member GetEnumerator : unit -&gt; CharEnumerator<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;...<br /><br />Full name: System.String<br /><br />--------------------<br />String(value: nativeptr&lt;char&gt;) : unit<br />String(value: nativeptr&lt;sbyte&gt;) : unit<br />String(value: char []) : unit<br />String(c: char, count: int) : unit<br />String(value: nativeptr&lt;char&gt;, startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int) : unit<br />String(value: char [], startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int, enc: Text.Encoding) : unit</div>
<div class="tip" id="fs40">val concat : sep:string -&gt; strings:seq&lt;string&gt; -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.String.concat</div>
<div class="tip" id="fs41">val i : Ident</div>
<div class="tip" id="fs42">val visitExpression : _arg1:SynExpr -&gt; unit<br /><br />Full name: Untypedtree.visitExpression<br /><em><br /><br />&#160;Walk over an expression - if expression contains two or three <br />&#160;sub-expressions (two if the &#39;else&#39; branch is missing), let expression<br />&#160;contains pattern and two sub-expressions</em></div>
<div class="tip" id="fs43">type SynExpr =<br />&#160;&#160;| Paren of SynExpr * range * range option * range<br />&#160;&#160;| Quote of SynExpr * bool * SynExpr * bool * range<br />&#160;&#160;| Const of SynConst * range<br />&#160;&#160;| Typed of SynExpr * SynType * range<br />&#160;&#160;| Tuple of SynExpr list * range list * range<br />&#160;&#160;| ArrayOrList of bool * SynExpr list * range<br />&#160;&#160;| Record of (SynType * SynExpr * range * BlockSeparator option * range) option * (SynExpr * BlockSeparator) option * (RecordFieldName * SynExpr option * BlockSeparator option) list * range<br />&#160;&#160;| New of bool * SynType * SynExpr * range<br />&#160;&#160;| ObjExpr of SynType * (SynExpr * Ident option) option * SynBinding list * SynInterfaceImpl list * range * range<br />&#160;&#160;| While of SequencePointInfoForWhileLoop * SynExpr * SynExpr * range<br />&#160;&#160;...<br />&#160;&#160;member IsArbExprAndThusAlreadyReportedError : bool<br />&#160;&#160;member Range : range<br />&#160;&#160;member RangeOfFirstPortion : range<br />&#160;&#160;member RangeSansAnyExtraDot : range<br /><br />Full name: Microsoft.FSharp.Compiler.Ast.SynExpr</div>
<div class="tip" id="fs44">union case SynExpr.IfThenElse: SynExpr * SynExpr * SynExpr option * SequencePointInfoForBinding * bool * Compiler.Range.range * Compiler.Range.range -&gt; SynExpr</div>
<div class="tip" id="fs45">val cond : SynExpr</div>
<div class="tip" id="fs46">val trueBranch : SynExpr</div>
<div class="tip" id="fs47">val falseBranchOpt : SynExpr option</div>
<div class="tip" id="fs48">module Option<br /><br />from Microsoft.FSharp.Core</div>
<div class="tip" id="fs49">val iter : action:(&#39;T -&gt; unit) -&gt; option:&#39;T option -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Option.iter</div>
<div class="tip" id="fs50">union case SynExpr.LetOrUse: bool * bool * SynBinding list * SynExpr * Compiler.Range.range -&gt; SynExpr</div>
<div class="tip" id="fs51">val bindings : SynBinding list</div>
<div class="tip" id="fs52">val body : SynExpr</div>
<div class="tip" id="fs53">val binding : SynBinding</div>
<div class="tip" id="fs54">union case SynBinding.Binding: SynAccess option * SynBindingKind * bool * bool * SynAttributes * PreXmlDoc * SynValData * SynPat * SynBindingReturnInfo option * SynExpr * Compiler.Range.range * SequencePointInfoForBinding -&gt; SynBinding</div>
<div class="tip" id="fs55">val access : SynAccess option</div>
<div class="tip" id="fs56">val kind : SynBindingKind</div>
<div class="tip" id="fs57">val inlin : bool</div>
<div class="tip" id="fs58">val mutabl : bool</div>
<div class="tip" id="fs59">val attrs : SynAttributes</div>
<div class="tip" id="fs60">val xmlDoc : PreXmlDoc</div>
<div class="tip" id="fs61">val data : SynValData</div>
<div class="tip" id="fs62">val retInfo : SynBindingReturnInfo option</div>
<div class="tip" id="fs63">val init : SynExpr</div>
<div class="tip" id="fs64">val m : Compiler.Range.range</div>
<div class="tip" id="fs65">val sp : SequencePointInfoForBinding</div>
<div class="tip" id="fs66">val expr : SynExpr</div>
<div class="tip" id="fs67">val visitDeclarations : decls:seq&lt;SynModuleDecl&gt; -&gt; unit<br /><br />Full name: Untypedtree.visitDeclarations<br /><em><br /><br />&#160;Walk over a list of declarations in a module. This is anything<br />&#160;that you can write as a top-level inside module (let bindings,<br />&#160;nested modules, type declarations etc.)</em></div>
<div class="tip" id="fs68">val decls : seq&lt;SynModuleDecl&gt;</div>
<div class="tip" id="fs69">val declaration : SynModuleDecl</div>
<div class="tip" id="fs70">type SynModuleDecl =<br />&#160;&#160;| ModuleAbbrev of Ident * LongIdent * range<br />&#160;&#160;| NestedModule of SynComponentInfo * SynModuleDecls * bool * range<br />&#160;&#160;| Let of bool * SynBinding list * range<br />&#160;&#160;| DoExpr of SequencePointInfoForBinding * SynExpr * range<br />&#160;&#160;| Types of SynTypeDefn list * range<br />&#160;&#160;| Exception of SynExceptionDefn * range<br />&#160;&#160;| Open of LongIdentWithDots * range<br />&#160;&#160;| Attributes of SynAttributes * range<br />&#160;&#160;| HashDirective of ParsedHashDirective * range<br />&#160;&#160;| NamespaceFragment of SynModuleOrNamespace<br />&#160;&#160;member Range : range<br /><br />Full name: Microsoft.FSharp.Compiler.Ast.SynModuleDecl</div>
<div class="tip" id="fs71">union case SynModuleDecl.Let: bool * SynBinding list * Compiler.Range.range -&gt; SynModuleDecl</div>
<div class="tip" id="fs72">val isRec : bool</div>
<div class="tip" id="fs73">val range : Compiler.Range.range</div>
<div class="tip" id="fs74">val visitModulesAndNamespaces : modulesOrNss:seq&lt;SynModuleOrNamespace&gt; -&gt; unit<br /><br />Full name: Untypedtree.visitModulesAndNamespaces<br /><em><br /><br />&#160;Walk over all module or namespace declarations <br />&#160;(basically &#39;module Foo =&#39; or &#39;namespace Foo.Bar&#39;)<br />&#160;Note that there is one implicitly, even if the file<br />&#160;does not explicitly define it..</em></div>
<div class="tip" id="fs75">val modulesOrNss : seq&lt;SynModuleOrNamespace&gt;</div>
<div class="tip" id="fs76">val moduleOrNs : SynModuleOrNamespace</div>
<div class="tip" id="fs77">Multiple items<br />union case SynModuleOrNamespace.SynModuleOrNamespace: LongIdent * bool * SynModuleDecls * PreXmlDoc * SynAttributes * SynAccess option * Compiler.Range.range -&gt; SynModuleOrNamespace<br /><br />--------------------<br />type SynModuleOrNamespace =<br />&#160;&#160;| SynModuleOrNamespace of LongIdent * bool * SynModuleDecls * PreXmlDoc * SynAttributes * SynAccess option * range<br />&#160;&#160;member Range : range<br /><br />Full name: Microsoft.FSharp.Compiler.Ast.SynModuleOrNamespace</div>
<div class="tip" id="fs78">val lid : LongIdent</div>
<div class="tip" id="fs79">val isMod : bool</div>
<div class="tip" id="fs80">val decls : SynModuleDecls</div>
<div class="tip" id="fs81">val xml : PreXmlDoc</div>
<div class="tip" id="fs82">val input : string<br /><br />Full name: Untypedtree.input</div>
<div class="tip" id="fs83">val file : string<br /><br />Full name: Untypedtree.file</div>
<div class="tip" id="fs84">val tree : ParsedInput<br /><br />Full name: Untypedtree.tree</div>
<div class="tip" id="fs85">val getUntypedTree : file:string * input:string -&gt; ParsedInput<br /><br />Full name: Untypedtree.getUntypedTree<br /><em><br /><br />&#160;Get untyped tree for a specified input</em></div>
<div class="tip" id="fs86">type ParsedInput =<br />&#160;&#160;| ImplFile of ParsedImplFileInput<br />&#160;&#160;| SigFile of ParsedSigFileInput<br />&#160;&#160;member Range : range<br /><br />Full name: Microsoft.FSharp.Compiler.Ast.ParsedInput</div>
<div class="tip" id="fs87">union case ParsedInput.ImplFile: ParsedImplFileInput -&gt; ParsedInput</div>
<div class="tip" id="fs88">val implFile : ParsedImplFileInput</div>
<div class="tip" id="fs89">Multiple items<br />union case ParsedImplFileInput.ParsedImplFileInput: string * bool * QualifiedNameOfFile * ScopedPragma list * ParsedHashDirective list * SynModuleOrNamespace list * bool -&gt; ParsedImplFileInput<br /><br />--------------------<br />type ParsedImplFileInput = | ParsedImplFileInput of string * bool * QualifiedNameOfFile * ScopedPragma list * ParsedHashDirective list * SynModuleOrNamespace list * bool<br /><br />Full name: Microsoft.FSharp.Compiler.Ast.ParsedImplFileInput</div>
<div class="tip" id="fs90">val fn : string</div>
<div class="tip" id="fs91">val script : bool</div>
<div class="tip" id="fs92">val name : QualifiedNameOfFile</div>
<div class="tip" id="fs93">val modules : SynModuleOrNamespace list</div>

        </div>
        <div class="span3">
           <a href="https://nuget.org/packages/FSharp.Compiler.Service">
            <img src="http://fsharp.github.io/FSharp.Compiler.Service/images/logo.png" style="width:140px;height:140px;margin:10px 0px 0px 35px;border-style:none;" />
          </a>
          <ul class="nav nav-list" id="menu">
            <li class="nav-header">F# Compiler Services</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.com/packages/FSharp.Compiler.Service">Get Library via NuGet</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Compiler.Service">Source Code on GitHub</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Compiler.Service/blob/master/LICENSE.md">License</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Compiler.Service/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/index.html">Home page</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/devnotes.html">Developer notes</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/fsharp-readme.html">F# compiler readme</a></li>

            <li class="nav-header">Available services</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/tokenizer.html">F# Language tokenizer</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/untypedtree.html">Processing untyped AST</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/editor.html">Using editor (IDE) services</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/interactive.html">Embedding F# interactive </a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/reference/index.html">API Reference</a> (Preliminary)</li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/fsharp/FSharp.Compiler.Service"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </body>
  </html>
