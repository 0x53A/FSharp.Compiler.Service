<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Interactive Service: Embedding F# Interactive
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="F# compiler services for creating IDE tools, language extensions and for F# embedding">
    <meta name="author" content="Microsoft Corporation, Dave Thomas, Anh-Dung Phan, Tomas Petricek">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="http://fsharp.github.io/FSharp.Compiler.Service/content/style.css" />
    <script type="text/javascript" src="http://fsharp.github.io/FSharp.Compiler.Service/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/fsharp/FSharp.Compiler.Service">github page</a></li>
        </ul>
        <h3 class="muted">F# Compiler Services</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1>Interactive Service: Embedding F# Interactive</h1>

<p>This tutorial demonstrates how to embed F# interactive in your application. F# interactive
is an interactive scripting environment that compiles F# code into highly efficient IL code
and executes it on the fly. The F# interactive service allows you to embed F# evaluation in 
your application.</p>

<blockquote>
  <p><strong>NOTE:</strong> There is a number of options for embedding F# Interactive. The easiest one is to use the 
<code>fsi.exe</code> process and communicate with it using standard input and standard output. In this
tutorial, we look at calling F# interactive directly through .NET API. However, if you have
no control over the input, it is a good idea to run F# interactive in a separate process
(one reason is that there is no way to handle <code>StackOverflowException</code> and so poorly written
script can terminate the host process.</p>
</blockquote>

<p>However, the F# interactive service is still useful, because you might want to wrap it in your
own executable that is then executed (and communicates with the rest of your application), or
if you only need to execute limited subset of F# code (e.g. generated by your own DSL).</p>

<h2>Starting the F# interactive</h2>

<p>First, we need to reference the libraries that contain F# interactive service:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">FSharp</span><span class="s">.</span><span class="s">Compiler</span><span class="s">.</span><span class="s">Service</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">Microsoft</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Compiler</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Interactive</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">Shell</span></pre>
</td>
</tr>
</table>

<p>To communicate with F# interactive, we need to create streams that represent input and
output. We will use those later to read the output printed as a result of evaluating some
F# code that prints:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">System</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">IO</span>

<span class="c">// Intialize output and input streams</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 9)" onmouseover="showTip(event, 'fs8', 9)" class="i">sbOut</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs9', 10)" onmouseover="showTip(event, 'fs9', 10)" class="i">Text</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 11)" onmouseover="showTip(event, 'fs10', 11)" class="i">StringBuilder</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 12)" onmouseover="showTip(event, 'fs11', 12)" class="i">sbErr</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="i">Text</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="i">StringBuilder</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="i">inStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="i">StringReader</span>(<span class="s">&quot;</span><span class="s">&quot;</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="i">outStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs15', 18)" onmouseover="showTip(event, 'fs15', 18)" class="i">StringWriter</span>(<span onmouseout="hideTip(event, 'fs8', 19)" onmouseover="showTip(event, 'fs8', 19)" class="i">sbOut</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 20)" onmouseover="showTip(event, 'fs16', 20)" class="i">errStream</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs15', 21)" onmouseover="showTip(event, 'fs15', 21)" class="i">StringWriter</span>(<span onmouseout="hideTip(event, 'fs11', 22)" onmouseover="showTip(event, 'fs11', 22)" class="i">sbErr</span>)

<span class="c">// Build command line arguments &amp; start FSI session</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 23)" onmouseover="showTip(event, 'fs17', 23)" class="i">argv</span> <span class="o">=</span> [| <span class="s">&quot;</span><span class="s">C</span><span class="s">:</span><span class="s">\\</span><span class="s">fsi</span><span class="s">.</span><span class="s">exe</span><span class="s">&quot;</span> |]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 24)" onmouseover="showTip(event, 'fs18', 24)" class="i">allArgs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 25)" onmouseover="showTip(event, 'fs19', 25)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 26)" onmouseover="showTip(event, 'fs20', 26)" class="i">append</span> <span onmouseout="hideTip(event, 'fs17', 27)" onmouseover="showTip(event, 'fs17', 27)" class="i">argv</span> [|<span class="s">&quot;</span><span class="s">-</span><span class="s">-</span><span class="s">noninteractive</span><span class="s">&quot;</span>|]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 28)" onmouseover="showTip(event, 'fs21', 28)" class="i">fsiConfig</span> <span class="o">=</span> 
      { <span class="c">// Connect the configuration through to the &#39;fsi&#39; object from FSharp.Compiler.Interactive.Settings</span>
        <span class="k">new</span> <span onmouseout="hideTip(event, 'fs22', 29)" onmouseover="showTip(event, 'fs22', 29)" class="i">FsiEvaluationSessionHostConfig</span> <span class="k">with</span> 
          <span class="k">member</span> <span class="i">__</span><span class="o">.</span><span class="i">FormatProvider</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 30)" onmouseover="showTip(event, 'fs23', 30)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 31)" onmouseover="showTip(event, 'fs24', 31)" class="i">FormatProvider</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 32)" onmouseover="showTip(event, 'fs25', 32)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 33)" onmouseover="showTip(event, 'fs26', 33)" class="i">FloatingPointFormat</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 34)" onmouseover="showTip(event, 'fs23', 34)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 35)" onmouseover="showTip(event, 'fs27', 35)" class="i">FloatingPointFormat</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 36)" onmouseover="showTip(event, 'fs25', 36)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 37)" onmouseover="showTip(event, 'fs28', 37)" class="i">AddedPrinters</span> <span class="o">=</span> 
              <span class="c">// Unfortunately the printers added by the users are not directly available in FSharp.Compiler.Interactive.Settings.</span>
              <span class="c">// They should be, but we want to avoid modifying FSharp.Compiler.Interactive.Settings to avoid republishing that DLL.</span>
              <span class="c">// So we access these via reflection</span>
              <span onmouseout="hideTip(event, 'fs29', 38)" onmouseover="showTip(event, 'fs29', 38)" class="i">typeof</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs1', 39)" onmouseover="showTip(event, 'fs1', 39)" class="i">Microsoft</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 40)" onmouseover="showTip(event, 'fs2', 40)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 41)" onmouseover="showTip(event, 'fs3', 41)" class="i">Compiler</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 42)" onmouseover="showTip(event, 'fs4', 42)" class="i">Interactive</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 43)" onmouseover="showTip(event, 'fs30', 43)" class="i">InteractiveSession</span><span class="o">&gt;</span><span class="o">.</span><span class="i">InvokeMember</span>(<span class="s">&quot;</span><span class="s">AddedPrinters</span><span class="s">&quot;</span>,(<span onmouseout="hideTip(event, 'fs6', 44)" onmouseover="showTip(event, 'fs6', 44)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 45)" onmouseover="showTip(event, 'fs31', 45)" class="i">Reflection</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 46)" onmouseover="showTip(event, 'fs32', 46)" class="i">BindingFlags</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 47)" onmouseover="showTip(event, 'fs33', 47)" class="i">GetProperty</span> <span class="o">|||</span> <span onmouseout="hideTip(event, 'fs6', 48)" onmouseover="showTip(event, 'fs6', 48)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 49)" onmouseover="showTip(event, 'fs31', 49)" class="i">Reflection</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 50)" onmouseover="showTip(event, 'fs32', 50)" class="i">BindingFlags</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 51)" onmouseover="showTip(event, 'fs34', 51)" class="i">NonPublic</span> <span class="o">|||</span> <span onmouseout="hideTip(event, 'fs6', 52)" onmouseover="showTip(event, 'fs6', 52)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 53)" onmouseover="showTip(event, 'fs31', 53)" class="i">Reflection</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 54)" onmouseover="showTip(event, 'fs32', 54)" class="i">BindingFlags</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 55)" onmouseover="showTip(event, 'fs35', 55)" class="i">Instance</span>),<span class="k">null</span>,<span onmouseout="hideTip(event, 'fs36', 56)" onmouseover="showTip(event, 'fs36', 56)" class="i">box</span> <span onmouseout="hideTip(event, 'fs23', 57)" onmouseover="showTip(event, 'fs23', 57)" class="i">fsi</span>, [| |]) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 58)" onmouseover="showTip(event, 'fs37', 58)" class="i">unbox</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 59)" onmouseover="showTip(event, 'fs25', 59)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 60)" onmouseover="showTip(event, 'fs38', 60)" class="i">ShowDeclarationValues</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 62)" onmouseover="showTip(event, 'fs39', 62)" class="i">ShowDeclarationValues</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 63)" onmouseover="showTip(event, 'fs25', 63)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 64)" onmouseover="showTip(event, 'fs40', 64)" class="i">ShowIEnumerable</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 65)" onmouseover="showTip(event, 'fs23', 65)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 66)" onmouseover="showTip(event, 'fs41', 66)" class="i">ShowIEnumerable</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 67)" onmouseover="showTip(event, 'fs25', 67)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 68)" onmouseover="showTip(event, 'fs42', 68)" class="i">ShowProperties</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 69)" onmouseover="showTip(event, 'fs23', 69)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 70)" onmouseover="showTip(event, 'fs43', 70)" class="i">ShowProperties</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 71)" onmouseover="showTip(event, 'fs25', 71)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs44', 72)" onmouseover="showTip(event, 'fs44', 72)" class="i">PrintSize</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 73)" onmouseover="showTip(event, 'fs23', 73)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 74)" onmouseover="showTip(event, 'fs45', 74)" class="i">PrintSize</span>  
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 75)" onmouseover="showTip(event, 'fs25', 75)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 76)" onmouseover="showTip(event, 'fs46', 76)" class="i">PrintDepth</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 77)" onmouseover="showTip(event, 'fs23', 77)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 78)" onmouseover="showTip(event, 'fs47', 78)" class="i">PrintDepth</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 79)" onmouseover="showTip(event, 'fs25', 79)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs48', 80)" onmouseover="showTip(event, 'fs48', 80)" class="i">PrintWidth</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 81)" onmouseover="showTip(event, 'fs23', 81)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 82)" onmouseover="showTip(event, 'fs49', 82)" class="i">PrintWidth</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 83)" onmouseover="showTip(event, 'fs25', 83)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs50', 84)" onmouseover="showTip(event, 'fs50', 84)" class="i">PrintLength</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 85)" onmouseover="showTip(event, 'fs23', 85)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 86)" onmouseover="showTip(event, 'fs51', 86)" class="i">PrintLength</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 87)" onmouseover="showTip(event, 'fs25', 87)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs52', 88)" onmouseover="showTip(event, 'fs52', 88)" class="i">ReportUserCommandLineArgs</span> <span class="k">with</span> <span onmouseout="hideTip(event, 'fs53', 89)" onmouseover="showTip(event, 'fs53', 89)" class="i">set</span> <span onmouseout="hideTip(event, 'fs54', 90)" onmouseover="showTip(event, 'fs54', 90)" class="i">args</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 91)" onmouseover="showTip(event, 'fs23', 91)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 92)" onmouseover="showTip(event, 'fs55', 92)" class="i">CommandLineArgs</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs54', 93)" onmouseover="showTip(event, 'fs54', 93)" class="i">args</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 94)" onmouseover="showTip(event, 'fs25', 94)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs56', 95)" onmouseover="showTip(event, 'fs56', 95)" class="i">StartServer</span>(<span onmouseout="hideTip(event, 'fs57', 96)" onmouseover="showTip(event, 'fs57', 96)" class="i">fsiServerName</span>) <span class="o">=</span>  <span onmouseout="hideTip(event, 'fs58', 97)" onmouseover="showTip(event, 'fs58', 97)" class="i">failwith</span> <span class="s">&quot;</span><span class="s">-</span><span class="s">-</span><span class="s">fsi</span><span class="s">-</span><span class="s">server</span><span class="s"> </span><span class="s">not</span><span class="s"> </span><span class="s">implemented</span><span class="s"> </span><span class="s">in</span><span class="s"> </span><span class="s">this</span><span class="s"> </span><span class="s">version</span><span class="s"> </span><span class="s">of</span><span class="s"> </span><span class="s">fsi</span><span class="s">.</span><span class="s">exe</span><span class="s">&quot;</span>
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 98)" onmouseover="showTip(event, 'fs25', 98)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 99)" onmouseover="showTip(event, 'fs59', 99)" class="i">EventLoopRun</span>() <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 100)" onmouseover="showTip(event, 'fs23', 100)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 101)" onmouseover="showTip(event, 'fs60', 101)" class="i">EventLoop</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 102)" onmouseover="showTip(event, 'fs61', 102)" class="i">Run</span>()
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 103)" onmouseover="showTip(event, 'fs25', 103)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 104)" onmouseover="showTip(event, 'fs62', 104)" class="i">EventLoopInvoke</span>(<span onmouseout="hideTip(event, 'fs63', 105)" onmouseover="showTip(event, 'fs63', 105)" class="i">f</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 106)" onmouseover="showTip(event, 'fs23', 106)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 107)" onmouseover="showTip(event, 'fs60', 107)" class="i">EventLoop</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 108)" onmouseover="showTip(event, 'fs64', 108)" class="i">Invoke</span>(<span onmouseout="hideTip(event, 'fs63', 109)" onmouseover="showTip(event, 'fs63', 109)" class="i">f</span>)
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 110)" onmouseover="showTip(event, 'fs25', 110)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs65', 111)" onmouseover="showTip(event, 'fs65', 111)" class="i">EventLoopScheduleRestart</span>() <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 112)" onmouseover="showTip(event, 'fs23', 112)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 113)" onmouseover="showTip(event, 'fs60', 113)" class="i">EventLoop</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs66', 114)" onmouseover="showTip(event, 'fs66', 114)" class="i">ScheduleRestart</span>()
          <span class="k">member</span> <span onmouseout="hideTip(event, 'fs25', 115)" onmouseover="showTip(event, 'fs25', 115)" class="i">__</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 116)" onmouseover="showTip(event, 'fs67', 116)" class="i">ConsoleReadLine</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs68', 117)" onmouseover="showTip(event, 'fs68', 117)" class="i">None</span> }

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 118)" onmouseover="showTip(event, 'fs69', 118)" class="i">fsi</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs70', 119)" onmouseover="showTip(event, 'fs70', 119)" class="i">FsiEvaluationSession</span>(<span onmouseout="hideTip(event, 'fs21', 120)" onmouseover="showTip(event, 'fs21', 120)" class="i">fsiConfig</span>, <span onmouseout="hideTip(event, 'fs18', 121)" onmouseover="showTip(event, 'fs18', 121)" class="i">allArgs</span>, <span onmouseout="hideTip(event, 'fs12', 122)" onmouseover="showTip(event, 'fs12', 122)" class="i">inStream</span>, <span onmouseout="hideTip(event, 'fs14', 123)" onmouseover="showTip(event, 'fs14', 123)" class="i">outStream</span>, <span onmouseout="hideTip(event, 'fs16', 124)" onmouseover="showTip(event, 'fs16', 124)" class="i">errStream</span>)  </pre>
</td>
</tr>
</table>

<h2>Evaluating and executing code</h2>

<p>The F# interactive service exposes two methods that can be used for interaction. The first
is <code>EvalExpression</code> which evaluates an expression and returns its result. The result contains
the returned value (as <code>obj</code>) and the statically inferred type of the value:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// Evaluate expression &amp; return the result</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 125)" onmouseover="showTip(event, 'fs71', 125)" class="i">evalExpression</span> <span onmouseout="hideTip(event, 'fs72', 126)" onmouseover="showTip(event, 'fs72', 126)" class="i">text</span> <span class="o">=</span>
  <span class="k">match</span> <span onmouseout="hideTip(event, 'fs69', 127)" onmouseover="showTip(event, 'fs69', 127)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs73', 128)" onmouseover="showTip(event, 'fs73', 128)" class="i">EvalExpression</span>(<span onmouseout="hideTip(event, 'fs72', 129)" onmouseover="showTip(event, 'fs72', 129)" class="i">text</span>) <span class="k">with</span>
  | <span onmouseout="hideTip(event, 'fs74', 130)" onmouseover="showTip(event, 'fs74', 130)" class="i">Some</span> <span onmouseout="hideTip(event, 'fs75', 131)" onmouseover="showTip(event, 'fs75', 131)" class="i">value</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs76', 132)" onmouseover="showTip(event, 'fs76', 132)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs75', 133)" onmouseover="showTip(event, 'fs75', 133)" class="i">value</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs77', 134)" onmouseover="showTip(event, 'fs77', 134)" class="i">ReflectionValue</span>
  | <span onmouseout="hideTip(event, 'fs68', 135)" onmouseover="showTip(event, 'fs68', 135)" class="i">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs76', 136)" onmouseover="showTip(event, 'fs76', 136)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Got</span><span class="s"> </span><span class="s">no</span><span class="s"> </span><span class="s">result</span><span class="s">!</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>The <code>EvalInteraction</code> method has no result. It can be used to evaluate side-effectful operations
such as printing, or other interactions that are not valid F# expressions, but can be entered in
the F# Interactive console. Such commands include <code>#time "on"</code> (and other directives), <code>open System</code>
and other top-level statements.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">/// Evaluate interaction &amp; ignore the result</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 137)" onmouseover="showTip(event, 'fs78', 137)" class="i">evalInteraction</span> <span onmouseout="hideTip(event, 'fs72', 138)" onmouseover="showTip(event, 'fs72', 138)" class="i">text</span> <span class="o">=</span> 
  <span onmouseout="hideTip(event, 'fs69', 139)" onmouseover="showTip(event, 'fs69', 139)" class="i">fsi</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs79', 140)" onmouseover="showTip(event, 'fs79', 140)" class="i">EvalInteraction</span>(<span onmouseout="hideTip(event, 'fs72', 141)" onmouseover="showTip(event, 'fs72', 141)" class="i">text</span>)</pre>
</td>
</tr>
</table>

<p>The two functions take string as an argument and evaluate (or execute) it as F# code. The code 
passed to them does not require <code>;;</code> at the end. Just enter the code that you want to execute:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs71', 142)" onmouseover="showTip(event, 'fs71', 142)" class="i">evalExpression</span> <span class="s">&quot;</span><span class="s">42</span><span class="s">+</span><span class="s">1</span><span class="s">&quot;</span>
<span onmouseout="hideTip(event, 'fs78', 143)" onmouseover="showTip(event, 'fs78', 143)" class="i">evalInteraction</span> <span class="s">&quot;</span><span class="s">printfn</span><span class="s"> </span><span class="s">\&quot;</span><span class="s">bye</span><span class="s">\&quot;</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h2>Exception handling</h2>

<p>If you want to handle compiler errors in a nicer way and report a useful error message, you might
want to use something like this:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">try</span> 
  <span onmouseout="hideTip(event, 'fs71', 144)" onmouseover="showTip(event, 'fs71', 144)" class="i">evalExpression</span> <span class="s">&quot;</span><span class="s">42</span><span class="s"> </span><span class="s">+</span><span class="s"> </span><span class="s">1</span><span class="s">.</span><span class="s">0</span><span class="s">&quot;</span>
<span class="k">with</span> <span onmouseout="hideTip(event, 'fs80', 145)" onmouseover="showTip(event, 'fs80', 145)" class="i">e</span> <span class="k">-&gt;</span>
  <span class="k">match</span> <span onmouseout="hideTip(event, 'fs80', 146)" onmouseover="showTip(event, 'fs80', 146)" class="i">e</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 147)" onmouseover="showTip(event, 'fs81', 147)" class="i">InnerException</span> <span class="k">with</span>
  | <span class="k">null</span> <span class="k">-&gt;</span> 
      <span onmouseout="hideTip(event, 'fs76', 148)" onmouseover="showTip(event, 'fs76', 148)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Error</span><span class="s"> </span><span class="s">evaluating</span><span class="s"> </span><span class="s">expression</span><span class="s"> </span><span class="s">(</span><span class="s">%</span><span class="s">s</span><span class="s">)</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs80', 149)" onmouseover="showTip(event, 'fs80', 149)" class="i">e</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 150)" onmouseover="showTip(event, 'fs82', 150)" class="i">Message</span>
  <span class="c">//| WrappedError(err, _) -&gt; </span>
  <span class="c">//    printfn &quot;Error evaluating expression (Wrapped: %s)&quot; err.Message</span>
  | _ <span class="k">-&gt;</span> 
      <span onmouseout="hideTip(event, 'fs76', 151)" onmouseover="showTip(event, 'fs76', 151)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Error</span><span class="s"> </span><span class="s">evaluating</span><span class="s"> </span><span class="s">expression</span><span class="s"> </span><span class="s">(</span><span class="s">%</span><span class="s">s</span><span class="s">)</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs80', 152)" onmouseover="showTip(event, 'fs80', 152)" class="i">e</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 153)" onmouseover="showTip(event, 'fs82', 153)" class="i">Message</span></pre>
</td>
</tr>
</table>

<div class="tip" id="fs1">namespace Microsoft</div>
<div class="tip" id="fs2">namespace Microsoft.FSharp</div>
<div class="tip" id="fs3">namespace Microsoft.FSharp.Compiler</div>
<div class="tip" id="fs4">namespace Microsoft.FSharp.Compiler.Interactive</div>
<div class="tip" id="fs5">module Shell<br /><br />from Microsoft.FSharp.Compiler.Interactive</div>
<div class="tip" id="fs6">namespace System</div>
<div class="tip" id="fs7">namespace System.IO</div>
<div class="tip" id="fs8">val sbOut : Text.StringBuilder<br /><br />Full name: Interactive.sbOut</div>
<div class="tip" id="fs9">namespace System.Text</div>
<div class="tip" id="fs10">Multiple items<br />type StringBuilder =<br />&#160;&#160;new : unit -&gt; StringBuilder + 5 overloads<br />&#160;&#160;member Append : value:string -&gt; StringBuilder + 18 overloads<br />&#160;&#160;member AppendFormat : format:string * arg0:obj -&gt; StringBuilder + 4 overloads<br />&#160;&#160;member AppendLine : unit -&gt; StringBuilder + 1 overload<br />&#160;&#160;member Capacity : int with get, set<br />&#160;&#160;member Chars : int -&gt; char with get, set<br />&#160;&#160;member Clear : unit -&gt; StringBuilder<br />&#160;&#160;member CopyTo : sourceIndex:int * destination:char[] * destinationIndex:int * count:int -&gt; unit<br />&#160;&#160;member EnsureCapacity : capacity:int -&gt; int<br />&#160;&#160;member Equals : sb:StringBuilder -&gt; bool<br />&#160;&#160;...<br /><br />Full name: System.Text.StringBuilder<br /><br />--------------------<br />Text.StringBuilder() : unit<br />Text.StringBuilder(capacity: int) : unit<br />Text.StringBuilder(value: string) : unit<br />Text.StringBuilder(value: string, capacity: int) : unit<br />Text.StringBuilder(capacity: int, maxCapacity: int) : unit<br />Text.StringBuilder(value: string, startIndex: int, length: int, capacity: int) : unit</div>
<div class="tip" id="fs11">val sbErr : Text.StringBuilder<br /><br />Full name: Interactive.sbErr</div>
<div class="tip" id="fs12">val inStream : StringReader<br /><br />Full name: Interactive.inStream</div>
<div class="tip" id="fs13">Multiple items<br />type StringReader =<br />&#160;&#160;inherit TextReader<br />&#160;&#160;new : s:string -&gt; StringReader<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member Peek : unit -&gt; int<br />&#160;&#160;member Read : unit -&gt; int + 1 overload<br />&#160;&#160;member ReadLine : unit -&gt; string<br />&#160;&#160;member ReadToEnd : unit -&gt; string<br /><br />Full name: System.IO.StringReader<br /><br />--------------------<br />StringReader(s: string) : unit</div>
<div class="tip" id="fs14">val outStream : StringWriter<br /><br />Full name: Interactive.outStream</div>
<div class="tip" id="fs15">Multiple items<br />type StringWriter =<br />&#160;&#160;inherit TextWriter<br />&#160;&#160;new : unit -&gt; StringWriter + 3 overloads<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member Encoding : Encoding<br />&#160;&#160;member GetStringBuilder : unit -&gt; StringBuilder<br />&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;member Write : value:char -&gt; unit + 2 overloads<br /><br />Full name: System.IO.StringWriter<br /><br />--------------------<br />StringWriter() : unit<br />StringWriter(formatProvider: IFormatProvider) : unit<br />StringWriter(sb: Text.StringBuilder) : unit<br />StringWriter(sb: Text.StringBuilder, formatProvider: IFormatProvider) : unit</div>
<div class="tip" id="fs16">val errStream : StringWriter<br /><br />Full name: Interactive.errStream</div>
<div class="tip" id="fs17">val argv : string []<br /><br />Full name: Interactive.argv</div>
<div class="tip" id="fs18">val allArgs : string []<br /><br />Full name: Interactive.allArgs</div>
<div class="tip" id="fs19">type Array =<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CopyTo : array:Array * index:int -&gt; unit + 1 overload<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator<br />&#160;&#160;member GetLength : dimension:int -&gt; int<br />&#160;&#160;member GetLongLength : dimension:int -&gt; int64<br />&#160;&#160;member GetLowerBound : dimension:int -&gt; int<br />&#160;&#160;member GetUpperBound : dimension:int -&gt; int<br />&#160;&#160;member GetValue : params indices:int[] -&gt; obj + 7 overloads<br />&#160;&#160;member Initialize : unit -&gt; unit<br />&#160;&#160;member IsFixedSize : bool<br />&#160;&#160;...<br /><br />Full name: System.Array</div>
<div class="tip" id="fs20">val append : array1:&#39;T [] -&gt; array2:&#39;T [] -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.append</div>
<div class="tip" id="fs21">val fsiConfig : FsiEvaluationSessionHostConfig<br /><br />Full name: Interactive.fsiConfig</div>
<div class="tip" id="fs22">type FsiEvaluationSessionHostConfig =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;abstract member EventLoopInvoke : codeToRun:(unit -&gt; &#39;T) -&gt; &#39;T<br />&#160;&#160;&#160;&#160;abstract member EventLoopRun : unit -&gt; bool<br />&#160;&#160;&#160;&#160;abstract member EventLoopScheduleRestart : unit -&gt; unit<br />&#160;&#160;&#160;&#160;abstract member StartServer : fsiServerName:string -&gt; unit<br />&#160;&#160;&#160;&#160;abstract member AddedPrinters : Choice&lt;(Type * (obj -&gt; string)),(Type * (obj -&gt; obj))&gt; list<br />&#160;&#160;&#160;&#160;abstract member ConsoleReadLine : (unit -&gt; string) option<br />&#160;&#160;&#160;&#160;abstract member FloatingPointFormat : string<br />&#160;&#160;&#160;&#160;abstract member FormatProvider : IFormatProvider<br />&#160;&#160;&#160;&#160;abstract member PrintDepth : int<br />&#160;&#160;&#160;&#160;abstract member PrintLength : int<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: Microsoft.FSharp.Compiler.Interactive.Shell.FsiEvaluationSessionHostConfig</div>
<div class="tip" id="fs23">val fsi : Compiler.Interactive.InteractiveSession<br /><br />Full name: Microsoft.FSharp.Compiler.Interactive.Settings.fsi</div>
<div class="tip" id="fs24">property Compiler.Interactive.InteractiveSession.FormatProvider: IFormatProvider</div>
<div class="tip" id="fs25">val __ : FsiEvaluationSessionHostConfig</div>
<div class="tip" id="fs26">property FsiEvaluationSessionHostConfig.FloatingPointFormat: string</div>
<div class="tip" id="fs27">property Compiler.Interactive.InteractiveSession.FloatingPointFormat: string</div>
<div class="tip" id="fs28">property FsiEvaluationSessionHostConfig.AddedPrinters: Choice&lt;(Type * (obj -&gt; string)),(Type * (obj -&gt; obj))&gt; list</div>
<div class="tip" id="fs29">val typeof&lt;&#39;T&gt; : Type<br /><br />Full name: Microsoft.FSharp.Core.Operators.typeof</div>
<div class="tip" id="fs30">type InteractiveSession<br />member AddPrintTransformer : (&#39;T -&gt; obj) -&gt; unit<br />member AddPrinter : (&#39;T -&gt; string) -&gt; unit<br />member private AddedPrinters : Choice&lt;(Type * (obj -&gt; string)),(Type * (obj -&gt; obj))&gt; list<br />member CommandLineArgs : string []<br />member EventLoop : IEventLoop<br />member FloatingPointFormat : string<br />member FormatProvider : IFormatProvider<br />member PrintDepth : int<br />member PrintLength : int<br />member PrintSize : int<br />member PrintWidth : int<br />member ShowDeclarationValues : bool<br />member ShowIEnumerable : bool<br />member ShowProperties : bool<br />member CommandLineArgs : string [] with set<br />member EventLoop : IEventLoop with set<br />member FloatingPointFormat : string with set<br />member FormatProvider : IFormatProvider with set<br />member PrintDepth : int with set<br />member PrintLength : int with set<br />member PrintSize : int with set<br />member PrintWidth : int with set<br />member ShowDeclarationValues : bool with set<br />member ShowIEnumerable : bool with set<br />member ShowProperties : bool with set<br /><br />Full name: Microsoft.FSharp.Compiler.Interactive.InteractiveSession</div>
<div class="tip" id="fs31">namespace System.Reflection</div>
<div class="tip" id="fs32">type BindingFlags =<br />&#160;&#160;| Default = 0<br />&#160;&#160;| IgnoreCase = 1<br />&#160;&#160;| DeclaredOnly = 2<br />&#160;&#160;| Instance = 4<br />&#160;&#160;| Static = 8<br />&#160;&#160;| Public = 16<br />&#160;&#160;| NonPublic = 32<br />&#160;&#160;| FlattenHierarchy = 64<br />&#160;&#160;| InvokeMethod = 256<br />&#160;&#160;| CreateInstance = 512<br />&#160;&#160;...<br /><br />Full name: System.Reflection.BindingFlags</div>
<div class="tip" id="fs33">field Reflection.BindingFlags.GetProperty = 4096</div>
<div class="tip" id="fs34">field Reflection.BindingFlags.NonPublic = 32</div>
<div class="tip" id="fs35">field Reflection.BindingFlags.Instance = 4</div>
<div class="tip" id="fs36">val box : value:&#39;T -&gt; obj<br /><br />Full name: Microsoft.FSharp.Core.Operators.box</div>
<div class="tip" id="fs37">val unbox : value:obj -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.unbox</div>
<div class="tip" id="fs38">property FsiEvaluationSessionHostConfig.ShowDeclarationValues: bool</div>
<div class="tip" id="fs39">property Compiler.Interactive.InteractiveSession.ShowDeclarationValues: bool</div>
<div class="tip" id="fs40">property FsiEvaluationSessionHostConfig.ShowIEnumerable: bool</div>
<div class="tip" id="fs41">property Compiler.Interactive.InteractiveSession.ShowIEnumerable: bool</div>
<div class="tip" id="fs42">property FsiEvaluationSessionHostConfig.ShowProperties: bool</div>
<div class="tip" id="fs43">property Compiler.Interactive.InteractiveSession.ShowProperties: bool</div>
<div class="tip" id="fs44">property FsiEvaluationSessionHostConfig.PrintSize: int</div>
<div class="tip" id="fs45">property Compiler.Interactive.InteractiveSession.PrintSize: int</div>
<div class="tip" id="fs46">property FsiEvaluationSessionHostConfig.PrintDepth: int</div>
<div class="tip" id="fs47">property Compiler.Interactive.InteractiveSession.PrintDepth: int</div>
<div class="tip" id="fs48">property FsiEvaluationSessionHostConfig.PrintWidth: int</div>
<div class="tip" id="fs49">property Compiler.Interactive.InteractiveSession.PrintWidth: int</div>
<div class="tip" id="fs50">property FsiEvaluationSessionHostConfig.PrintLength: int</div>
<div class="tip" id="fs51">property Compiler.Interactive.InteractiveSession.PrintLength: int</div>
<div class="tip" id="fs52">property FsiEvaluationSessionHostConfig.ReportUserCommandLineArgs: string []</div>
<div class="tip" id="fs53">val set : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt; (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.set</div>
<div class="tip" id="fs54">val args : string []</div>
<div class="tip" id="fs55">property Compiler.Interactive.InteractiveSession.CommandLineArgs: string []</div>
<div class="tip" id="fs56">abstract member FsiEvaluationSessionHostConfig.StartServer : fsiServerName:string -&gt; unit</div>
<div class="tip" id="fs57">val fsiServerName : string</div>
<div class="tip" id="fs58">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs59">abstract member FsiEvaluationSessionHostConfig.EventLoopRun : unit -&gt; bool</div>
<div class="tip" id="fs60">property Compiler.Interactive.InteractiveSession.EventLoop: Compiler.Interactive.IEventLoop</div>
<div class="tip" id="fs61">abstract member Compiler.Interactive.IEventLoop.Run : unit -&gt; bool</div>
<div class="tip" id="fs62">abstract member FsiEvaluationSessionHostConfig.EventLoopInvoke : codeToRun:(unit -&gt; &#39;T) -&gt; &#39;T</div>
<div class="tip" id="fs63">val f : (unit -&gt; &#39;a)</div>
<div class="tip" id="fs64">abstract member Compiler.Interactive.IEventLoop.Invoke : (unit -&gt; &#39;T) -&gt; &#39;T</div>
<div class="tip" id="fs65">abstract member FsiEvaluationSessionHostConfig.EventLoopScheduleRestart : unit -&gt; unit</div>
<div class="tip" id="fs66">abstract member Compiler.Interactive.IEventLoop.ScheduleRestart : unit -&gt; unit</div>
<div class="tip" id="fs67">property FsiEvaluationSessionHostConfig.ConsoleReadLine: (unit -&gt; string) option</div>
<div class="tip" id="fs68">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs69">val fsi : FsiEvaluationSession<br /><br />Full name: Interactive.fsi</div>
<div class="tip" id="fs70">Multiple items<br />type FsiEvaluationSession =<br />&#160;&#160;new : fsiConfig:FsiEvaluationSessionHostConfig * argv:string [] * inReader:TextReader * outWriter:TextWriter * errorWriter:TextWriter -&gt; FsiEvaluationSession<br />&#160;&#160;member EvalExpression : code:string -&gt; FsiValue option<br />&#160;&#160;member EvalInteraction : code:string -&gt; unit<br />&#160;&#160;member GetCompletions : longIdent:string -&gt; seq&lt;string&gt;<br />&#160;&#160;member Interrupt : unit -&gt; unit<br />&#160;&#160;member ReportUnhandledException : exn:exn -&gt; unit<br />&#160;&#160;member Run : unit -&gt; unit<br />&#160;&#160;member TypeCheckScriptFragment : code:string -&gt; UntypedParseInfo * TypeCheckResults<br />&#160;&#160;member IsGui : bool<br />&#160;&#160;member LCID : int option<br /><br />Full name: Microsoft.FSharp.Compiler.Interactive.Shell.FsiEvaluationSession<br /><br />--------------------<br />new : fsiConfig:FsiEvaluationSessionHostConfig * argv:string [] * inReader:TextReader * outWriter:TextWriter * errorWriter:TextWriter -&gt; FsiEvaluationSession</div>
<div class="tip" id="fs71">val evalExpression : text:string -&gt; unit<br /><br />Full name: Interactive.evalExpression<br /><em><br /><br />&#160;Evaluate expression &amp; return the result</em></div>
<div class="tip" id="fs72">val text : string</div>
<div class="tip" id="fs73">member FsiEvaluationSession.EvalExpression : code:string -&gt; FsiValue option</div>
<div class="tip" id="fs74">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs75">val value : FsiValue</div>
<div class="tip" id="fs76">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs77">property FsiValue.ReflectionValue: obj</div>
<div class="tip" id="fs78">val evalInteraction : text:string -&gt; unit<br /><br />Full name: Interactive.evalInteraction<br /><em><br /><br />&#160;Evaluate interaction &amp; ignore the result</em></div>
<div class="tip" id="fs79">member FsiEvaluationSession.EvalInteraction : code:string -&gt; unit</div>
<div class="tip" id="fs80">val e : exn</div>
<div class="tip" id="fs81">property Exception.InnerException: exn</div>
<div class="tip" id="fs82">property Exception.Message: string</div>

        </div>
        <div class="span3">
           <a href="https://nuget.org/packages/FSharp.Compiler.Service">
            <img src="http://fsharp.github.io/FSharp.Compiler.Service/images/logo.png" style="width:140px;height:140px;margin:10px 0px 0px 35px;border-style:none;" />
          </a>
          <ul class="nav nav-list" id="menu">
            <li class="nav-header">F# Compiler Services</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.com/packages/FSharp.Compiler.Service">Get Library via NuGet</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Compiler.Service">Source Code on GitHub</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Compiler.Service/blob/master/LICENSE.md">License</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Compiler.Service/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/index.html">Home page</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/devnotes.html">Developer notes</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/fsharp-readme.html">F# compiler readme</a></li>

            <li class="nav-header">Available services</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/tokenizer.html">F# Language tokenizer</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/untypedtree.html">Processing untyped AST</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/editor.html">Using editor (IDE) services</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/interactive.html">Embedding F# interactive</a></li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/compiler.html">Embedding F# compiler</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="http://fsharp.github.io/FSharp.Compiler.Service/reference/index.html">API Reference</a> (Preliminary)</li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/fsharp/FSharp.Compiler.Service"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </body>
  </html>
